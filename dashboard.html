<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Scuba</title>

    <!-- Bootstrap -->
    <link href="../vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- bootstrap-progressbar -->
    <link href="../vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">

    <!-- Custom Theme Style -->
    <link href="../build/css/custom.min.css" rel="stylesheet">
    <!-- Scuba Style -->
    <link href="../build/css/scuba_style.css" rel="stylesheet">

    <link rel="shortcut icon" type="image/x-icon" href="../resources/favicon.ico" />
</head>

<body class="nav-md" ng-app="ScubaApp" ng-controller="mainController">
    <div class="container body">
        <div class="main_container">

            <!-- Left Menu -->
            <div class="col-md-3 left_col">
                <div class="left_col scroll-view">
                    <div class="navbar nav_title" style="border: 0;">
                        <a class="site_title"><img src="../resources/Imperva_White.png" width="40"><span>Scuba</span></a>
                    </div>
                    <div class="clearfix"></div>
                    <!-- Quick Info -->
                    <div class="profile">
                        <div class="profile_pic">
                            <img ng-src="../resources/databases/DEFAULT.png" class="img-circle profile_img ng-cloak">
                        </div>
                        <div class="profile_info ng-cloak">
                            <span tooltip="{{serverAddressTooltipText}}">{{serverAddressText}}</span>
                            <h2>{{results['user']}}</h2>
                        </div>
                    </div>
                    <!-- /Quick Info -->
                    <br />
                    <!-- Sidebar Menu -->
                    <div class="main_menu_side hidden-print main_menu">
                        <div class="menu_section active ng-cloak">
                            <h3>{{results['database']}}</h3>
                            <ul class="nav side-menu" style="">
                                <li class="active">
                                    <a href="javascript:void(0)"><img src="../resources/Comply.png" width="48" /> Assessments </a>
                                </li>
                                <li>
                                    <a target="_blank" ng-href="{{getSecureSphereUrl()}}">
                                        <img src="../resources/Databases.png" width="48" /> Database Discovery
                                        <span class="label label-success pull-right">Commercial version</span>
                                    </a>
                                </li>
                                <li>
                                    <a target="_blank" ng-href="{{getSecureSphereUrl()}}">
                                        <img src="../resources/Reputation.png" width="48" /> Data Classification
                                        <span class="label label-success pull-right">Commercial version</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <!-- /Sidebar Menu -->
                </div>
            </div>
            <!-- /Left Menu -->
            <!-- Top Navigation -->
            <div class="top_nav">
                <div class="nav_menu">
                    <nav>
                        <div class="nav toggle">
                            <a id="menu_toggle"><i class="fa fa-bars" style="margin-bottom:10px"></i></a>
                        </div>

                        <div ng-show="emptyScanResultsFound" class="topErrorMessage ng-cloak">
                            <i class="fa fa-exclamation-triangle"></i> <strong>Scan ended with issues. <a ng-href="mailto:Support-Scuba@imperva.com?Subject=Scuba%20v{{results.version}}%20-%20empty%20scan%20report">Click here to contact our Support team</a></strong>
                        </div>

                        <a ng-href="{{getImpervaUrl()}}" target="_blank">
                            <img src="../resources/ImpervaFull.png" width="150" align="right" style="margin-top: 10px; margin-right: 15px" />
                        </a>
                    </nav>
                </div>
            </div>
            <!-- /Top Navigation -->
            <!-- Page Content -->
            <div class="right_col ng-cloak" role="main">
                <!-- Top Tiles -->
                <div class="row tile_count">
                    <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count" style="margin-top:10px">
                        <span class="count_top"><i class="fa fa-line-chart"></i> Risk </span>
                        <div class="count">
                            <i ng-class="getRiskSummaryClass()"></i>
                        </div>
                        <span class="count_bottom">{{getRiskSummaryText()}}</span>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count" style="margin-top:10px" tooltip="These results are partial. Full details are given in commercial version" tooltip-placement="bottom">
                        <span class="count_top"><i class="fa fa-list-ul"></i> CIS </span>
                        <div class="count">
                            <i ng-class="getRegulationClass('CIS')"></i>
                        </div>
                        <span class="count_bottom">{{getComplianceSummaryText('CIS')}}</span>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count" style="margin-top:10px" tooltip="These results are partial. Full details are given in commercial version" tooltip-placement="bottom">
                        <span class="count_top"><i class="fa fa-list-ul"></i> DISA (STIG) </span>
                        <div class="count">
                            <i ng-class="getRegulationClass('DISA (STIG)')"></i>
                        </div>
                        <span class="count_bottom">{{getComplianceSummaryText('DISA (STIG)')}}</span>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count" style="margin-top:10px">
                        <span class="count_top"><i class="fa fa-times-circle"></i> Total Failures</span>
                        <div ng-class="getNumberOfFailuresClass()">{{ GetNumberInThousands(STATUSES['Failed'].counter) }}</div>
                        <span class="count_bottom">Out of {{GetNumberInThousands(results['assessments'].length)}} tests</span>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count" style="margin-top:10px">
                        <span class="count_top"><i class="fa fa-clock-o"></i> Scan Time (minutes)</span>
                        <div class="count">{{results['scanTimeMinutes']}}</div>
                        <span class="count_bottom">{{results['scanTimeEnd']}}</span>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6 pull-right" style="margin-top: 10px">
                        <div class="tile-stats">
                            <div class="icon" >
                                <img src="../resources/ContactSales.png" width="50" style="margin-left: 25px; margin-top: 5px">
                            </div>
                            <div class="contactTile">
                                <p><a class="contactLink" ng-href="mailto:sales@imperva.com?Subject=Scuba%20v{{results.version}}"><i class="fa fa-envelope-o"></i>&nbsp;&nbsp;Contact us</a></p>
                                <p><a class="contactLink" target="_blank" ng-href="{{getOnlineFormUrl()}}"><i class="fa fa-file-text-o"></i>&nbsp;&nbsp;Online form</a></p>
                                <p><a class="contactLink" target="_blank" href="tel:1-866-926-4678"><i class="fa fa-phone"></i>&nbsp;&nbsp;1-866-926-4678</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Top Tiles -->
                <!-- Central Widgets -->
                <div class="row">
                    <!-- Compliance Status -->
                    <div class="col-md-4 col-sm-4 col-xs-12">
                        <div class="x_panel tile fixed_height_280">
                            <div class="x_title">
                                <h2>Compliance</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <div class="dashboard-widget-content">
                                    <ul class="quick-list">
                                        <li ng-repeat="(key, value) in REGULATIONS">
                                            <i ng-class="getRegulationClass(key)" ng-style="getRegulationStyle(key)"></i>{{key}}<a target="_blank" ng-href="{{value.link}}"> <small><i class="fa fa-external-link"></i></small></a>
                                        </li>
                                    </ul>
                                    <div class="sidebar-widget" tooltip="These results are partial. Full details are given in commercial version" tooltip-placement="left" >
                                        <h2>Compliance Readiness</h2>
                                        <canvas width="150" height="80" id="complianceGauge" class="" style="width: 200px; height: 100px;"></canvas>
                                        <div class="goal-wrapper">
                                            <span class="goal-value pull-right">%</span>
                                            <span id="gauge-text" class="gauge-value pull-right"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /Compliance Status -->
                    <!-- Scan Results -->
                    <div class="col-md-4 col-sm-4 col-xs-12" ng-show="results['assessments'].length > 0">
                        <div class="x_panel tile fixed_height_280 overflow_hidden">
                            <div class="x_title">
                                <h2>Results</h2>

                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <table class="" style="width:100%">
                                    <tr>
                                        <td>
                                            <canvas id="canvas1" height="140" width="140" style="margin: 15px 10px 10px 0"></canvas>
                                        </td>
                                        <td>
                                            <table class="tile_info">
                                                <tr ng-repeat="(key, value) in STATUSES" ng-if="STATUSES[key].percentage > 0">
                                                    <td>
                                                        <p>
                                                            <i class="fa fa-square" ng-style="{'color': STATUSES[key].doughnutBackground}"></i>{{key}}
                                                            <span ng-show="{{key == 'Info'}}" tooltip-append-to-body="true" tooltip-placement="bottom" class="pull-right"
                                                                  tooltip="These results indicate potential risks. They should be assessed in accordance with your company policies">
                                                                <i class="fa fa-question-circle pull-right"></i>
                                                            </span>
                                                        </p>
                                                    </td>
                                                    <td>{{STATUSES[key].percentage}}%</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div ng-show="{{hasErrors()}}" class="risk warningMessage">
                                <i class="fa fa-exclamation-triangle"></i> <a target="_blank" href="../../Documentation/Imperva-Scuba-User-Guide.pdf">Finished with errors. Please check <strong>{{results.user}}</strong> permissions <i class="fa fa-file-pdf-o"></i></a>
                            </div>
                        </div>
                    </div>
                    <!-- /Scan Results -->
                    <!-- Failures -->
                    <div class="col-md-4 col-sm-4 col-xs-12" ng-show="STATUSES['Failed'].counter > 0">
                        <div class="x_panel tile fixed_height_280">
                            <div class="x_title">
                                <h2>Failures</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <div class="widget_summary" ng-repeat='(key, value) in SEVERITIES' ng-if="value.failures > 0">
                                    <div class="w_left w_25">
                                        <span ng-class="SEVERITIES[key].customClass">{{ key }}</span>
                                    </div>
                                    <div class="w_center w_55">
                                        <div class="progress">
                                            <div class="progress-bar bg-purple" role="progressbar" ng-style="{{getAssessmentSeverityStyle(value.failures)}}">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="w_right w_20">
                                        <span style="font-size: 14px">{{ GetNumberInThousands(value.failures) }}</span>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /Failures -->
                </div>
                <!-- /Central Widgets -->
                <!-- Assessments Details -->
                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>Assessments Details</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <div class="tableSummary">
                                    <strong>{{summaryText}}</strong>
                                    <div class="pageNavigation" style="float: right">
                                        <a href="#void" ng-style="getPreviousPageButtonStyle()" ng-click="setPage(1)" class="fa fa-caret-square-o-left"></a>
                                        <a href="#void" ng-style="getPreviousPageButtonStyle()" ng-click="setPage(activePage.value-1)" class="fa fa-caret-left"> </a>
                                        <strong>{{getPagesNavigationText()}}</strong>
                                        <a href="#void" ng-style="getNextPageButtonStyle()" ng-click="setPage(activePage.value+1)" class="fa fa-caret-right"> </a>
                                        <a href="#void" ng-style="getNextPageButtonStyle()" ng-click="setPage(maxPages)" class="fa fa-caret-square-o-right"></a>
                                    </div>
                                    <hr />
                                </div>

                                <table class="table table-bordered table-striped table-hover table-assessments">
                                    <thead>
                                        <tr>
                                            <th ng-repeat="(key, value) in COLUMNS" ng-click="sortHeader(value)" ng-class="getHeaderClass(value)" style="min-width: 110px; cursor: pointer">
                                                {{key}} <span ng-class="getSortClass(value)"></span>
                                            </th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        <tr ng-repeat-start="assessment in results['assessments'] | filter: showTestInTable | orderBy: customFilter:sortReverse | limitTo: MAX_EVENTS_IN_PAGE:fromIndex" ng-click="tableRowClicked(assessment)" ng-style="getCursor(assessment)">
                                            <td>
                                                <i ng-class="getExtraDetailsClass(assessment)" ng-show="hasExtraDetails(assessment)"></i>
                                                <span>{{ assessment.test }}</span>
                                                <span class="badge tableIcon" ng-show="hasRemediation(assessment)" tooltip="{{getRemediationTooltip(assessment)}}">
                                                    <i class="fa fa-medkit"></i>
                                                </span>
                                                <span class="badge tableIcon" ng-show="hasData(assessment)" tooltip="{{getDataTooltip(assessment)}}">
                                                    <i class="fa fa-table"></i> {{formatDataCountForTableIcon(assessment)}}
                                                </span>
                                            </td>
                                            <td width="20%">{{ assessment.category }}</td>
                                            <td width="5%">
                                                <div ng-repeat="line in assessment.regulations track by $index">{{line}}<br /></div>
                                            </td>
                                            <td width="5%">
                                                <span ng-class="getAssessmentSeverityClass(assessment)">{{ assessment.severityText }}</span>
                                            </td>
                                        </tr>
                                        <tr class="nohover" ng-show="assessment.showDetails">
                                            <td colspan="3" class="extraDetails">
                                                <span style="padding-bottom: 10px" ng-show="assessment.details.length > 0">
                                                    <strong>DETAILS</strong><br />
                                                    <div ng-repeat="line in assessment.detailsFixed track by $index">{{line}}<br /></div>
                                                    <hr />
                                                </span>
                                                <span ng-show="assessment.description.length > 0">
                                                    <strong>DESCRIPTION</strong><br />
                                                    <div ng-repeat="line in assessment.descriptionFixed track by $index">{{line}}<br /></div>
                                                    <hr />
                                                </span>
                                                <span ng-show="isVulnerability(assessment)> 0">
                                                    <strong>LINK</strong><br />
                                                    <div><a target="_blank" ng-href="{{ assessment.cveLink }}">{{ assessment.cveName }} <i class="testlink fa fa-external-link"></i></a><br /></div>
                                                    <hr />
                                                </span>
                                                <div ng-show="hasData(assessment)">
                                                    <strong>DATA</strong><br /><br />
                                                    <table class="table table-bordered table-striped">
                                                        <thead>
                                                            <tr>
                                                                <th ng-repeat="columnHeader in assessment.data[0] track by $index">{{columnHeader}}</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr ng-repeat="rowData in assessment.data | limitTo:results.dataRowsProcessLimit:1 track by $index ">
                                                                <!-- Up to results.dataRowsProcessLimit rows-->
                                                                <td ng-repeat="columnData in rowData track by $index">{{columnData}}</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <div ng-show="{{hasExceededDataLimit(assessment)}}" class="risk warningMessage">
                                                        <i class="fa fa-exclamation-triangle"></i> <a target="_blank" ng-href="{{getSecureSphereUrl()}}">Showing only {{GetNumberInThousands(results.dataRowsProcessLimit)}} results out of {{formatDataCountForExceeded(assessment)}}. Full results in <strong>commercial version</strong> <i class="fa fa-external-link"></i></a>
                                                    </div>
                                                    <hr />
                                                </div>
                                                <span ng-show="assessment.remediation.length > 0">
                                                    <strong>REMEDIATION</strong><br />
                                                    <div ng-repeat="line in assessment.remediationFixed track by $index">{{line}}<br /></div>
                                                    <hr />
                                                </span>
                                            </td>
                                            <td class="score">
                                                <span ng-show="{{assessment.score != INVALID_ASSESSMENT_SCORE}}" ng-class="getAssessmentSeverityClass(assessment)">{{ assessment.score }}</span>
                                            </td>
                                        </tr>
                                        <tr ng-repeat-end ng-show="false"><td colspan="4"></td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Assessments Details -->
                <!-- GA -->
                <div>
                    <iframe class="GAiframe" ng-src="{{GA_Address}}"></iframe>
                </div>
                <!-- /GA -->
            </div>
            <!-- /Page Content -->
            <!-- Footer Content -->
            <footer class="ng-cloak">
                <div class="pull-right">
                    Scuba {{results.version}} ({{results.adcContent}}) | Database Assessments by <a target="_blank" ng-href="{{getImpervaUrl()}}">IMPERVA</a>
                </div>
                <div class="clearfix"></div>
            </footer>
            <!-- /Footer Content -->
        </div>
    </div>

    <!-- Results -->
    <script src="./AssessmentResults.js"></script>
    <!--<script src="./AssessmentResultsDebug.js"></script>-->
    <!-- AngularJS -->
    <script src="../vendors/AngularJS/angular.js"></script>
    <script src="../vendors/AngularJS/ui-bootstrap-tpls-0.12.0.js"></script>
    <script src="../build/js/app.js"></script>
    <!-- jQuery -->
    <script src="../vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="../vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- NProgress -->
    <script src="../vendors/nprogress/nprogress.js"></script>
    <!-- Chart.js -->
    <script src="../vendors/Chart.js/dist/Chart.min.js"></script>
    <!-- gauge.js -->
    <script src="../vendors/gauge.js/dist/gauge.min.js"></script>
    <!-- bootstrap-progressbar -->
    <script src="../vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
    <!-- base32 -->
    <script src="../vendors/base32/base32.js"></script>
    <!-- Custom Theme Scripts -->
    <script src="../build/js/custom.min.js"></script>
</body>
</html>
